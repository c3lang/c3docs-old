<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Changes from C - C3 Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Changes from C";
    var mkdocs_page_input_path = "changesfromc.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ebnf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bnf.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> C3 Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">About C3</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Installing</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../setup/">Setup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../firstproject/">Your first project</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../primer/">A quick primer on C3</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Documentation</span></p>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Changes from C</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#no-mandatory-header-files">No mandatory header files</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#removal-of-the-old-c-macro-system">Removal of the old C macro system</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#import-and-modules">Import and modules</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#member-access-using-even-for-pointers">Member access using . even for pointers</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#different-operator-precedence">Different operator precedence</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#removal-of-the-const-type-qualifier">Removal of the const type qualifier</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#fixed-arrays-do-not-decay-and-have-copy-sematics">Fixed arrays do not decay and have copy sematics</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#removal-of-multiple-declaration-syntax">Removal of multiple declaration syntax</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#integer-promotions-rules-and-safe-signed-unsigned-comparisons">Integer promotions rules and safe signed-unsigned comparisons</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#goto-removed">Goto removed</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#locals-variables-are-implictly-zeroed">Locals variables are implictly zeroed</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#mandatory-around-casts">Mandatory () around casts</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compound-literal-syntax-changed">Compound literal syntax changed</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../compare/">Comparisons with other languages</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../modules/">Modules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../types/">Types</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../define/">Define</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../arrays/">Arrays</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../functions/">Functions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../statements/">Statements</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../expressions/">Expressions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../errorhandling/">Errors</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../undefinedbehaviour/">Undefined behaviour</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../conversion/">Conversions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../builtinmacros/">Built-in Macros</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../precedence/">Precedence</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../generics/">Generics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../macros/">Macros</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../reflection/">Reflection</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../preconditions/">Pre and post conditions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../library/">Library</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ideas/">Crazy ideas</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../naming/">Naming rules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../comments/">Comments & Docs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../attributes/">Attributes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cinterop/">C Interop</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../syntax/">Grammar</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sample/">More code examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../specification/">Specification</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Build system</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../buildintro/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../project/">Project Structure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../buildcommands/">Commands</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Development</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../contribute/">Contribute</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../changes/">Changes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../rejectedideas/">Rejected ideas</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">C3 Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation &raquo;</li>
        
      
    
    <li>Changes from C</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="changes-from-c">Changes from C</h1>
<p>Although C3 is trying to improve on C, this does not only mean addition of features, but also removal, or breaking changes:</p>
<h5 id="no-mandatory-header-files">No mandatory header files</h5>
<p>There is a C3 interchange header format for declaring interfaces of libraries, but it is only used for special applications.</p>
<h5 id="removal-of-the-old-c-macro-system">Removal of the old C macro system</h5>
<p>The old C macro system is replaced by a new C3 macro system.</p>
<h5 id="import-and-modules">Import and modules</h5>
<p>C3 uses module imports instead of header includes to link modules together.</p>
<h5 id="member-access-using-even-for-pointers">Member access using <code>.</code> even for pointers</h5>
<p>The <code>-&gt;</code> operator is removed, access uses dot for both direct and pointer access. Note that this is just single access: to access a pointer of a pointer (e.g. <code>int**</code>) an explicit dereference would be needed.</p>
<h5 id="different-operator-precedence">Different operator precedence</h5>
<p>Notably bit operations have higher precedence than +/-, making code like this: <code>a &amp; b == c</code> evaluate like <code>(a &amp; b) == c</code> instead of C's <code>a &amp; (b == c)</code>. See the page about <a href="../precedence">precedence rules</a>.</p>
<h5 id="removal-of-the-const-type-qualifier">Removal of the const type qualifier</h5>
<p>The const qualifier is only retained for actual constant variables. C3 uses a special type of <a href="../preconditions">post condition</a> for functions to indicate that they do not alter in parameters.</p>
<pre><code>/**
 * This function ensures that foo is not changed in the function, nor is bar.x altered.
 * @ensure const(foo), const(bar.x)
 **/
func void test(Foo* foo, Bar* bar)
{
    bar.y = foo.x;
    // bar.x = foo.x - compile time error!
    // foo.x = bar.y - compile time error!
}
</code></pre>
<p><em>Rationale: const correctness requires littering const across the code base. Although const is useful, it provides weaker guarantees that it appears.</em></p>
<h5 id="fixed-arrays-do-not-decay-and-have-copy-sematics">Fixed arrays do not decay and have copy sematics</h5>
<p>C3 has three different array types. Variable arrays and slices decay to pointers, but fixed arrays are value objects and do not decay.</p>
<pre><code>int[3] a = { 1, 2, 3 };
int[4]* b = &amp;a; // No conversion
int* c = a; // ERROR
int* d = &amp;a; // Valid implicit conversion
int* e = b; // Valid implicit conversion
int[3] f = a; // Copy by value!
</code></pre>
<h5 id="removal-of-multiple-declaration-syntax">Removal of multiple declaration syntax</h5>
<p>Only a single declaration is allowed per statement in C3:</p>
<pre><code>int i, j; // ERROR
int a;    // Fine
</code></pre>
<p>In conditionals, a special form of multiple declarations are allowed but each must then provide its type:</p>
<pre><code>for (int i = 0, int j = 1; i &lt; 10; i++, j++) { ... }
</code></pre>
<h5 id="integer-promotions-rules-and-safe-signed-unsigned-comparisons">Integer promotions rules and safe signed-unsigned comparisons</h5>
<p>Promotion rules for integer types are different from C. Most prominently, C3 does left side widening in the case of <code>long x = intValue1 + intValue2</code>. In C this becomes:
<code>long x = (long)(intValue1 + intValue2)</code>, whereas in C3 it would behaves as <code>long x = (long)intValue1 + (long)intValue2</code> to minimize chance of overflow. (read more on the <a href="../conversion">conversion page</a>. C3 also adds <em>safe signed-unsigned comparisons</em>: this means that comparing signed and unsigned values will always yield the correct result:</p>
<pre><code>// The code below will print &quot;Hello C3!&quot; on C3 and &quot;Hello C!&quot; in C.
int i = -1;
uint j = 1;
// int z = i + j; &lt;- Error, explicit cast needed.
if (i &lt; j)
{
  printf(&quot;Hello C3!\n&quot;);
}
else
{
  printf(&quot;Hello C!\n&quot;);
}
</code></pre>
<h5 id="goto-removed">Goto removed</h5>
<p><code>goto</code> is removed and replaced with labelled <code>break</code> and <code>continue</code> together with the <code>nextcase</code> statement that allows you to jump between cases in a <code>switch</code> statement.</p>
<p><em>Rationale: It is very difficult to make goto work well with defer and implicit unwrapping of failables. It is not just making the compiler harder to write, but
the code is harder to understand as well. The replacements together with <code>defer</code> cover many if not all usages of <code>goto</code> in regular code.</em></p>
<h5 id="locals-variables-are-implictly-zeroed">Locals variables are implictly zeroed</h5>
<p>In C global variables are implicitly zeroed out, but local variables aren't. In C3 local variables are zeroed out by default, but may be explicitly undefined to get the C behaviour.</p>
<p><em>Rationale: In the "zero-is-initialization" paradigm, zeroing variables, in particular structs, is very common. By offering zero initialization by default this avoids a whole class of vulnerabilites.
Another alternative that was considered for C3 was mandatory initialization,
but this adds a lot of extra boilerplate. 
C3 also offers a way to opt out of zero-initialization, so the change comes at no performance loss.</em></p>
<h5 id="mandatory-around-casts">Mandatory () around casts</h5>
<pre><code class="language-c">// C style casts:
int x = (int) c;

// C3
int x = (int)(c);
</code></pre>
<p><em>Rationale: removes visual ambiguity for casts.</em></p>
<h5 id="compound-literal-syntax-changed">Compound literal syntax changed</h5>
<pre><code class="language-c">// C style:
callFoo((Foo) { 1, 2, 3 });

// C++ style (1):
callFoo(Foo(1, 2, 3));

// C++ style (2):
callFoo(Foo { 1, 2, 3 });

// C3:
callFoo(Foo({ 1, 2, 3 }));
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../compare/" class="btn btn-neutral float-right" title="Comparisons with other languages">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../primer/" class="btn btn-neutral" title="A quick primer on C3"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../primer/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../compare/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
