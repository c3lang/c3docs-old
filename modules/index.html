<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Modules - C3 Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Modules";
    var mkdocs_page_input_path = "modules.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ebnf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/bnf.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> C3 Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">About C3</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Installing</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../setup/">Setup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../firstproject/">Your first project</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../primer/">A quick primer on C3</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../allfeatures/">Feature list</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Documentation</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../changesfromc/">Changes from C</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../compare/">Comparisons with other languages</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Modules</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#details">Details</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#importing-modules">Importing modules</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#implicit-imports">Implicit imports</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#visibility">Visibility</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#overriding-symbol-visibility-rules">Overriding symbol visibility rules</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#changing-the-default-visibility">Changing the default visibility</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#linker-visibility-and-exports">Linker visibility and exports</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#using-functions-and-types-from-other-modules">Using functions and types from other modules</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#module-sections">Module sections</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#versioning-and-dynamic-inclusion">Versioning and dynamic inclusion</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#textual-includes">Textual includes</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#include">$include</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#exec">$exec</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#exec-scripting">$exec scripting</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../types/">Types</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../define/">Define</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../arrays/">Arrays</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../functions/">Functions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../statements/">Statements</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../expressions/">Expressions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../variables/">Variables</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../optionals/">Optionals and error handling</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../compiletime/">Compile time evaluation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../contracts/">Contracts</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../generics/">Generics</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../macros/">Macros</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../reflection/">Reflection</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../operators/">Operator overloading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../anyinterfaces/">Any and protocols</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../undefinedbehaviour/">Undefined behaviour</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../conversion/">Conversions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../precedence/">Precedence</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../builtins/">Builtins</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../libraries/">Libraries</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../standard_library/">Standard Library</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ideas/">More ideas</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../naming/">Naming rules</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../comments/">Comments & Docs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../attributes/">Attributes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../asm/">Inline asm</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cinterop/">C Interop</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../syntax/">Grammar</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sample/">More code examples</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../specification/">Specification</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Build system</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../buildintro/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../project/">Project Structure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../buildcommands/">Commands</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Development</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../contribute/">Contribute</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../changes/">Changes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../rejectedideas/">Rejected ideas</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">C3 Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Documentation &raquo;</li>
        
      
    
    <li>Modules</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="modules">Modules</h1>
<p>C3 groups functions, types, variables and macros into namespaces called modules. When doing builds, any C3 file must start with the <code>module</code> keyword, specifying the module. When compiling single files, the module is not needed and the module name is assumed to be the file name, converted to lower case, with any invalid characters replaced by underscore (<code>_</code>).</p>
<p>A module can consist of multiple files, e.g.</p>
<p><code>file_a.c3</code></p>
<pre><code>module foo;

/* ... */
</code></pre>
<p><code>file_b.c3</code></p>
<pre><code>module foo;

/* ... */
</code></pre>
<p><code>file_c.c3</code></p>
<pre><code>module bar;

/* ... */
</code></pre>
<p>Here <code>file_a.c3</code> and <code>file_b.c3</code> belong to the same module, <strong>foo</strong> while <code>file_c.c3</code> belongs to to <strong>bar</strong>.</p>
<h2 id="details">Details</h2>
<p>Some details about the C3 module system:</p>
<ul>
<li>Modules can be arbitrarily nested, e.g. <code>module foo::bar::baz;</code> to create the sub module baz in the sub module <code>bar</code> of the module <code>foo</code>.</li>
<li>Module names must be alphanumeric lower case letters plus the underscore character: <code>_</code>.</li>
<li>Module names are limited to 31 characters.</li>
<li>Modules may be spread across multiple files.</li>
<li>A single file may have multiple module declarations.</li>
<li>Each declaration of a distinct module is called a <em>module section</em>.</li>
</ul>
<h2 id="importing-modules">Importing modules</h2>
<p>Modules are imported using the <code>import</code> statement. Imports always <em>recursively import</em> sub-modules. Any module
will automatically import all other modules with the same parent module.</p>
<p><code>foo.c3</code></p>
<pre><code>module some::foo;
fn void test() {}
</code></pre>
<p><code>bar.c3</code></p>
<pre><code>module bar;
import some;
// import some::foo; &lt;- not needed, as it is a sub module to "some"
fn void test()
{
    foo::test();
    // some::foo::test() also works.
}
</code></pre>
<p>In some cases there may be ambiguities, in which case the full path can be used to resolve the ambiguity:</p>
<p><code>abc.c3</code></p>
<pre><code>module abc;
struct Context
{
    int a;
}
</code></pre>
<p><code>def.c3</code></p>
<pre><code>module def;
struct Context
{
    void* ptr;
}
</code></pre>
<p><code>test.c3</code></p>
<pre><code>module test1;
import def, abc;
// Context c = {} &lt;- ambiguous
abc::Context c = {};
</code></pre>
<h2 id="implicit-imports">Implicit imports</h2>
<p>The module system will also implicitly import:</p>
<ol>
<li>The <code>std::core</code> module (and sub modules).</li>
<li>Any other module sharing the same top module. E.g. the module <code>foo::abc</code> will implicitly also import modules <code>foo</code> and <code>foo::cde</code> if they exist.</li>
</ol>
<h2 id="visibility">Visibility</h2>
<p>All files in the same module share the same global declaration namespace. By default a symbol is visible to all other modules.
To make a symbol only visible inside the module, use the <code>@private</code> attribute.</p>
<pre><code>module foo;

fn void init() { .. }

fn void open() @private { .. }
</code></pre>
<p>In this example, the other modules can use the init() function after importing foo, but only files in the foo module can use open(), as it is specified as <code>private</code>.</p>
<p>It's possible to further restrict visibility: <code>@local</code> works like <code>@private</code> except it's only visible in the 
local context.</p>
<pre><code>// File foo.c3
module foo;
fn void abc() @private { ... }
fn void def() @local { ... }

// File foo2.c3
module foo;
fn void test()
{
    abc(); // Access of private in the same module is ok
    // def(); &lt;- Error: function is local to foo.c3
}
</code></pre>
<h2 id="overriding-symbol-visibility-rules">Overriding symbol visibility rules</h2>
<p>By using <code>import &lt;module&gt; @public</code>, it's possible to access another moduleÂ´s private symbols.
Many other module systems have hierarchal visibility rules, but the <code>import @public</code> feature allows 
visibility to be manipulated in a more ad-hoc manner without imposing hard rules.</p>
<p>For example, you may provide a library with two modules: "mylib::net" and "mylib::file" - which both use functions
and types from a common "mylib::internals" module. The two libraries use <code>import mylib::internals @public</code>
to access this module's private functions and type. To an external user of the library, the "mylib::internals"
does not seem to exist, but inside of your library you use it as a shared dependency.</p>
<p>A simple example:</p>
<pre><code>// File a.c3
module a;

fn void a_function() @private { ... }

// File b.c3
module b;

fn void b_function() @private { ... }

// File c.c3
module c;
import a;
import b @public;

fn void test() 
{
  a::a_function(); // &lt;-- error, a_function is private
  b::b_function(); // Allowed since import converted it to "public" in this context.
}
</code></pre>
<p><em>Note: <code>@local</code> visibility cannot be overridden using a "@public" import.</em></p>
<h2 id="changing-the-default-visibility">Changing the default visibility</h2>
<p>In a normal module, global declarations will be public by default. If some other
visibility is desired, it's possible to declare <code>@private</code> or <code>@local</code> after the module name.
It will affect all declaration in the same section.</p>
<pre><code>module foo @private;

fn void ab_private() { ... } // Private

module foo;

fn void ab_public() { ... } // Public

module bar;
import foo;

fn void test()
{
    foo::ab_public(); // Works
    // foo::ab_private(); &lt;- Error, private method
}
</code></pre>
<p>If the default visibility is <code>@private</code> or <code>@local</code>, using <code>@public</code> sets the visibility to public:</p>
<pre><code>module foo @private;

fn void ab_private() { ... }        // Private
fn void ab_public() @public { ... } // Public
</code></pre>
<h2 id="linker-visibility-and-exports">Linker visibility and exports</h2>
<p>A function or global prefixed <code>extern</code> will be assumed to be linked in later.
An "extern" function may not have a body, and global variables are prohibited
from having an init expression.</p>
<p>The attribute <code>@export</code> explicitly marks a function as being exported when 
creating a (static or dynamic) library. It has no particular effect when
compiling as an executable.</p>
<h2 id="using-functions-and-types-from-other-modules">Using functions and types from other modules</h2>
<p>As a rule, functions, macros, constants, variables and types in the same module do not need any namespace prefix. For imported modules the following rules hold:</p>
<ol>
<li>Functions, macros, constants and variables require <em>at least</em> the (sub-) module name.</li>
<li>Types do not require the module name unless the name is ambiguous.</li>
<li>In case of ambiguity, only so many levels of module names are needed as to make the symbol unambiguous.</li>
</ol>
<pre><code>// File a.c3

module a;

struct Foo { ... }
struct Bar { ... }
struct TheAStruct { ... }

fn void anAFunction() { ... }

// File b.c3

module b;

struct Foo { ... }
struct Bar { ... }
struct TheBStruct { ... }

fn void aBFunction() { ... }

// File c.c3
module c;
import a, b;

struct TheCStruct { ... }
struct Bar { ... }

fn void aCFunction() { ... }

fn void test()
{
    TheAStruct stA;
    TheBStruct stB;
    TheCStruct stC;
    // Name required to avoid ambiguity;
    b::Foo stBFoo;
    // Will always pick the current module's 
    // name.
    Bar bar;
    // Namespace required:
    a::aAFunction();
    b::aBFunction();
    // A local symbol does not require it:
    aCFunction(); 
}
</code></pre>
<p>This means that the rule for the common case can be summarized as</p>
<blockquote>
<p>Types are used without prefix; functions, variables, macros and constants are prefixed with the sub module name.</p>
</blockquote>
<h2 id="module-sections">Module sections</h2>
<p>A single file may have multiple module declarations, even for the same module. This allows us to write
for example:</p>
<pre><code>// File foo.c3
module foo;
fn int hello_world()
{
    return my_hello_world();
}

module foo @private;
import std::io;         // The import is only visible in this section.
fn int my_hello_world() // @private by default
{
    io::printn("Hello, world\n");
    return 0;
}

module foo @test;
fn void test_hello() // @test by default
{
    assert(hello_world() == 0);
}
</code></pre>
<h2 id="versioning-and-dynamic-inclusion">Versioning and dynamic inclusion</h2>
<p><em>NOTE: This feature may significantly change.</em></p>
<p>When including <em>dynamic</em> libraries, it is possible to use optional functions and globals. This is done using the
<code>@dynamic</code> attribute.</p>
<p>An example library could have this:</p>
<p><code>dynlib.c3i</code></p>
<pre><code>module dynlib;
fn void do_something() @dynamic(4.0)
fn void do_something_else() @dynamic(0, 5.0)
fn void do_another_thing() @dynamic(0, 2.5)
</code></pre>
<p>Importing the dynamic library and setting the base version to 4.5 and minimum version to 3.0, we get the following:</p>
<p><code>test.c3</code></p>
<pre><code>import dynlib;
fn void test()
{
    if (@available(dynlib::do_something))
    {
        dynlib::do_something();
    }
    else
    {
        dynlib::do_someting_else();
    }  
}
</code></pre>
<p>In this example the code would run <code>do_something</code> if available (that is, when the dynamic library is 4.0 or higher), or 
fallback to <code>do_something_else</code> otherwise.</p>
<p>If we tried to conditionally add something not available in the compilation itself, that is a compile time error:</p>
<pre><code>if (@available(dynlib::do_another_thing))  
{
    dynlib::do_another_thing(); // Error: This function is not available with 3.0
}
</code></pre>
<p>Versionless dynamic loading is also possible:</p>
<p><code>maybe_dynlib.c3i</code></p>
<pre><code>module maybe_dynlib;
fn void testme() @dynamic;
</code></pre>
<p><code>test2.c3</code></p>
<pre><code>import maybe_dynlib;
fn void testme2()
{
    if (@available(maybe_dynlib::testme))
    {
        dynlib::testme();
    }
}
</code></pre>
<p>This allows things like optionally loading dynamic libraries on the platforms where this is available.</p>
<h2 id="textual-includes">Textual includes</h2>
<h3 id="include">$include</h3>
<p>It's sometimes useful to include an entire file, doing so employs the <code>$include</code> function.
Includes are only valid at the top level.</p>
<p>File <code>Foo.c3</code></p>
<pre><code>module foo;

$include(&quot;Foo.x&quot;);

fn void test() 
{
    io::printf(&quot;%d&quot;, testX(2));
}    
</code></pre>
<p>File <code>Foo.x</code></p>
<pre><code>fn testX(int i) 
{ 
    return i + 1; 
}
</code></pre>
<p>The result is as if <code>Foo.c3</code> contained the following:</p>
<pre><code>module foo;

fn testX(int i) 
{ 
    return i + 1; 
}

fn void test() 
{
    io::printf(&quot;%d&quot;, testX(2));
}    
</code></pre>
<p>The include may use an absolute or relative path, the relative path is always relative to the source file in which the include appears.</p>
<p>Note that to use it, the <strong>trust level</strong> of the compiler must be set to at least 2 with
the --trust option (i.e. use <code>--trust=include</code> or <code>--trust=full</code> from the command line).</p>
<h3 id="exec">$exec</h3>
<p>An alternative to <code>$include</code> is <code>$exec</code> which is similar to include, but instead includes the output of an external
program as the included text.</p>
<p>An example:</p>
<pre><code class="language-c">import std::io;

// On Linux or MacOS this will insert 'String a = &quot;Hello world!&quot;;'
$exec(&quot;echo&quot;, &quot;String a = \\\&quot;Hello world!\\\&quot;\\;&quot;);

fn void main()
{
    io::printn(a);
}
</code></pre>
<p>Using <code>$exec</code> requires <strong>full trust level</strong>, which is enabled with <code>-trust=full</code> from the command line.</p>
<p>'$exec' will by default run from the <code>/scripts</code> directory for projects, for non-project builds,
the current directory is used as well.</p>
<h4 id="exec-scripting">$exec scripting</h4>
<p><code>$exec</code> allows a special scripting mode, where one or more C3 files are compiled on the fly and 
run by <code>$exec</code>.</p>
<pre><code class="language-c">import std::io;

// Compile foo.c3 and bar.c3 in the /scripts directory, invoke the resulting binary
// with the argument 'test'
$exec(&quot;foo.c3;bar.c3&quot;, &quot;test&quot;);

fn void main()
{
    ...
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../types/" class="btn btn-neutral float-right" title="Types">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../examples/" class="btn btn-neutral" title="Examples"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../examples/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../types/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
